var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},LINQ;(function(n){function ot(){for(var t=[],e,f,n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];return e=this,f=t[0]instanceof Array?t[0]:t,new u(function(){return new r(i.Blank,function(){return this.Yield(f[Math.floor(Math.random()*f.length)])},i.Blank)})}function st(){for(var t=[],e,f,n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];return e=this,f=t[0]instanceof Array?t[0]:t,new u(function(){var n=0;return new r(i.Blank,function(){return n>=f.length&&(n=0),this.Yield(f[n++])},i.Blank)})}function p(){return new u(function(){return new r(i.Blank,i.False,i.Blank)})}function o(){return p()}function a(n){return n?n:o()}function ht(n){return n===undefined||n===null?o():v(n,1)}function ct(n){return n===undefined||n===null?o():v(n,1)}function lt(n){var t=this;return n===undefined||n===null?o():new u(function(){var t=0;return new r(i.Blank,function(){return t<n.length?this.Yield(n.charAt(t++)):!1},i.Blank)})}function h(n){return n?new k(n):o()}function s(n){return n?n instanceof Array?h(n):a(n):o()}function rt(n){var t=this;return n?new u(function(){var t=[],u=0;return new r(function(){for(var i in n)n[i]instanceof Function||t.push({Key:i,Value:n[i]})},function(){return u<t.length?this.Yield(t[u++]):!1},i.Blank)}):o()}function w(n){var e=this;if(n===undefined||n===null)return o();if(n instanceof u)return a(n);if(typeof n===f.Number)return ht(n);if(typeof n===f.Boolean)return ct(n);if(typeof n===f.String)return lt(n);if(typeof n!==f.Function){if(typeof n.length===f.Number)return h(n);if(!(n instanceof Object)&&t.IsIEnumerable(n))return new u(function(){var u=!0,t;return new r(function(){return t=new Enumerator(n)},function(){return u?u=!1:t.moveNext(),t.atEnd()?!1:this.Yield(t.item())},i.Blank)})}return rt(n)}function at(n){return v(n,1)}function vt(n,t,f){var e=this;return f||(f=""),t instanceof RegExp&&(f+=t.ignoreCase?"i":"",f+=t.multiline?"m":"",t=t.source),f.indexOf("g")===-1&&(f+="g"),new u(function(){var u;return new r(function(){return u=new RegExp(t,f)},function(){var t=u.exec(n);return t?this.Yield(t):!1},i.Blank)})}function yt(n,t,i){return(i===undefined||i===null)&&(i=1),tt(n,i).Take(t)}function pt(n,t,i){return(i===undefined||i===null)&&(i=1),it(n,i).Take(t)}function wt(n,t,i){return(i===undefined||i===null)&&(i=1),n<t?tt(n,i).TakeWhile(function(n){return n<=t}):it(n,i).TakeWhile(function(n){return n>=t})}function v(n,t){var f=this;return t!==undefined&&t!==null?v(n).Take(t):new u(function(){return new r(i.Blank,function(){return this.Yield(n)},i.Blank)})}function bt(n,t){var i=this;return new u(function(){var i=null;return new r(function(){return i=n()},function(){return this.Yield(i)},function(){i!==null&&(t(i),i=null)})})}function ut(n,t){var f=this;return t!==undefined&&t!==null?ut(n).Take(t):new u(function(){return new r(i.Blank,function(){return this.Yield(n())},i.Blank)})}function tt(n,t){var f=this;return(n===undefined||n===null)&&(n=0),(t===undefined||t===null)&&(t=1),new u(function(){var u;return new r(function(){return u=n-t},function(){return this.Yield(u+=t)},i.Blank)})}function it(n,t){var f=this;return(n===undefined||n===null)&&(n=0),(t===undefined||t===null)&&(t=1),new u(function(){var u;return new r(function(){return u=n+t},function(){return this.Yield(u-=t)},i.Blank)})}function kt(n,t){var f=this;return t=t||i.Identity,new u(function(){var f=!0,u;return new r(i.Blank,function(){return f?(f=!1,u=n,this.Yield(u)):(u=t(u),this.Yield(u))},i.Blank)})}function ft(n,t){var i=new et(n.keySelector,n.descending,t);return n.parent?ft(n.parent,i):i}var i={Identity:function(n){return n},True:function(){return!0},False:function(){return!1},Blank:function(){},Null:function(){return null}},f={Boolean:"boolean",Number:"number",String:"string",Object:"object",Undefined:typeof undefined,Function:typeof function(){}},e,g,r,t,l,c,y,nt,u,et,b,k,d;(function(n){n[n.Before=0]="Before",n[n.Running=1]="Running",n[n.After=2]="After"})(e||(e={})),g=function(){function n(){this.current=null}return n.prototype.Current=function(){return this.current},n.prototype.Yield=function(n){return this.current=n,!0},n}(),n.Yielder=g,r=function(){function n(n,t,i){this.yielder=new g,this.state=e.Before,this.initialize=n,this.tryGetNext=t,this.dispose=i}return n.prototype.Current=function(){return this.yielder.Current()},n.prototype.MoveNext=function(){try{switch(this.state){case e.Before:this.state=e.Running,this.initialize();case e.Running:return this.tryGetNext.apply(this.yielder)?!0:(this.Dispose(),!1);case e.After:return!1}}catch(n){this.Dispose();throw n;}},n.prototype.Dispose=function(){if(this.state===e.Running)try{this.dispose()}finally{this.state=e.After}},n}(),n.IEnumerator=r,function(n){function t(n){if(typeof Enumerator!==f.Undefined)try{return new Enumerator(n),!0}catch(t){}return!1}function i(n,t){return n===t?0:n>t?1:-1}function r(n){n&&n.Dispose()}function u(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function e(n){var u,i,t,r,e;if(n===null)return"null";if(n===undefined)return"undefined";if(typeof n===f.Number)return u=Math.floor(n%1e4),u.toString();if(typeof n===f.String){if(i=n,t=0,i.length==0)return"0";for(r=0;r<i.length;r++)e=i.charCodeAt(r),t=(t<<5)-t+e|0;return t.toString()}return typeof n.toString===f.Function?n.toString():Object.prototype.toString.call(n)}n.IsIEnumerable=t,n.Compare=i,n.Dispose=r,n.HasOwnProperty=u,n.ComputeHashCode=e}(t||(t={})),l=function(){function n(){this.FirstEntry=null,this.LastEntry=null}return n.prototype.AddLast=function(n){this.LastEntry!==null?(this.LastEntry.Next=n,n.Prev=this.LastEntry,this.LastEntry=n):this.FirstEntry=this.LastEntry=n},n.prototype.Replace=function(n,t){n.Prev!==null?(n.Prev.Next=t,t.Prev=n.Prev):this.FirstEntry=t,n.Next!==null?(n.Next.Prev=t,t.Next=n.Next):this.LastEntry=t},n.prototype.Remove=function(n){n.Prev!==null?n.Prev.Next=n.Next:this.FirstEntry=n.Next,n.Next!==null?n.Next.Prev=n.Prev:this.LastEntry=n.Prev},n}(),c=function(){function n(n){this.count=0,this.linkedList=new l,this.buckets={},this.compareSelector=n?n:i.Identity}return n.prototype.AddRange=function(n){for(var t=0;t<n.length;t++)this.Add(n[t])},n.prototype.Add=function(n){var e=this.compareSelector(n),f=t.ComputeHashCode(e),u={Value:n,Prev:null,Next:null},i,r;if(t.HasOwnProperty(this.buckets,f)){for(i=this.buckets[f],r=0;r<i.length;r++)if(this.compareSelector(i[r].Value)===e){this.linkedList.Replace(i[r],u),i[r]=u;return}i.push(u)}else this.buckets[f]=[u];this.count++,this.linkedList.AddLast(u)},n.prototype.Contains=function(n){var u=this.compareSelector(n),f=t.ComputeHashCode(u),r,i;if(!t.HasOwnProperty(this.buckets,f))return!1;for(r=this.buckets[f],i=0;i<r.length;i++)if(this.compareSelector(r[i].Value)===u)return!0;return!1},n.prototype.Clear=function(){this.count=0,this.buckets={},this.linkedList=new l},n.prototype.Remove=function(n){var f=this.compareSelector(n),u=t.ComputeHashCode(f),i,r;if(t.HasOwnProperty(this.buckets,u))for(i=this.buckets[u],r=0;r<i.length;r++)if(this.compareSelector(i[r].Value)===f){this.linkedList.Remove(i[r]),i.splice(r,1),i.length===0&&delete this.buckets[u],this.count--;return}},n.prototype.Count=function(){return this.count},n}(),n.Collection=c,y=function(){function n(n){this.count=0,this.linkedList=new l,this.buckets={},this.compareSelector=n?n:i.Identity}return n.prototype.Add=function(n,i){var o=this.compareSelector(n),e=t.ComputeHashCode(o),f={Value:{Key:n,Value:i},Prev:null,Next:null},r,u;if(t.HasOwnProperty(this.buckets,e)){for(r=this.buckets[e],u=0;u<r.length;u++)if(this.compareSelector(r[u].Value.Key)===o){this.linkedList.Replace(r[u],f),r[u]=f;return}r.push(f)}else this.buckets[e]=[f];this.count++,this.linkedList.AddLast(f)},n.prototype.Get=function(n){var f=this.compareSelector(n),e=t.ComputeHashCode(f),r,i,u;if(!t.HasOwnProperty(this.buckets,e))return undefined;for(r=this.buckets[e],i=0;i<r.length;i++)if(u=r[i],this.compareSelector(u.Value.Key)===f)return u.Value.Value;return undefined},n.prototype.Set=function(n,i){var e=this.compareSelector(n),o=t.ComputeHashCode(e),u,r,f;if(t.HasOwnProperty(this.buckets,o))for(u=this.buckets[o],r=0;r<u.length;r++)if(this.compareSelector(u[r].Value.Key)===e)return f={Value:{Key:n,Value:i},Prev:null,Next:null},this.linkedList.Replace(u[r],f),u[r]=f,!0;return!1},n.prototype.Contains=function(n){var u=this.compareSelector(n),f=t.ComputeHashCode(u),r,i;if(!t.HasOwnProperty(this.buckets,f))return!1;for(r=this.buckets[f],i=0;i<r.length;i++)if(this.compareSelector(r[i].Value.Key)===u)return!0;return!1},n.prototype.Clear=function(){this.count=0,this.buckets={},this.linkedList=new l},n.prototype.Remove=function(n){var f=this.compareSelector(n),u=t.ComputeHashCode(f),i,r;if(t.HasOwnProperty(this.buckets,u))for(i=this.buckets[u],r=0;r<i.length;r++)if(this.compareSelector(i[r].Value.Key)===f){this.linkedList.Remove(i[r]),i.splice(r,1),i.length===0&&delete this.buckets[u],this.count--;return}},n.prototype.Count=function(){return this.count},n.prototype.ToEnumerable=function(){var n=this;return new u(function(){var t=null;return new r(function(){t=n.linkedList.FirstEntry},function(){if(t!==null){var n={Key:t.Value.Key,Value:t.Value.Value};return t=t.Next,this.Yield(n)}return!1},i.Blank)})},n}(),n.Dictionary=y,nt=function(){function n(n){this.dictionary=n}return n.prototype.Count=function(){return this.dictionary.Count()},n.prototype.Get=function(n){return h(this.dictionary.Get(n))},n.prototype.Contains=function(n){return this.dictionary.Contains(n)},n.prototype.ToEnumerable=function(){return this.dictionary.ToEnumerable().Select(function(n){return new d(n.Key,n.Value)})},n}(),n.Lookup=nt,n.Choice=ot,n.Cycle=st,n.Empty=p,n.From=w,n.Return=at,n.Matches=vt,n.Range=yt,n.RangeDown=pt,n.RangeTo=wt,n.Repeat=v,n.RepeatWithFinalize=bt,n.Generate=ut,n.ToInfinity=tt,n.ToNegativeInfinity=it,n.Unfold=kt,u=function(){function n(n){this.GetEnumerator=n}return n.prototype.OfType=function(n){var t;switch(n){case Number:t=f.Number;break;case String:t=f.String;break;case Boolean:t=f.Boolean;break;case Function:t=f.Function;break;default:t=""}return t?this.Where(function(n){return typeof n===t}):this.Where(function(t){return t instanceof n})},n.prototype.OrderBy=function(n){return new b(this,n,!1)},n.prototype.OrderByDescending=function(n){return new b(this,n,!0)},n.prototype.CascadeBreadthFirst=function(u,f){var e=this;return u=u||i.Identity,f=f||i.Identity,new n(function(){var n,o=0,i=[];return new r(function(){return n=e.GetEnumerator()},function(){for(;;){if(n.MoveNext())return i.push(n.Current()),this.Yield(f(n.Current(),o));var r=h(i).SelectMany(u);if(r.Any())o++,i=[],t.Dispose(n),n=r.GetEnumerator();else return!1}},function(){return t.Dispose(n)})})},n.prototype.CascadeDepthFirst=function(u,f){var e=this;return u=u||i.Identity,f=f||i.Identity,new n(function(){var i=[],n;return new r(function(){return n=e.GetEnumerator()},function(){for(;;){if(n.MoveNext()){var r=f(n.Current(),i.length);return i.push(n),n=w(u(n.Current())).GetEnumerator(),this.Yield(r)}if(i.length<=0)return!1;t.Dispose(n),n=i.pop()}},function(){try{t.Dispose(n)}finally{h(i).ForEach(function(n){return n.Dispose()})}})})},n.prototype.Flatten=function(){var u=this;return new n(function(){var f,n=null;return new r(function(){return f=u.GetEnumerator()},function(){for(;;){if(n){if(n.MoveNext())return this.Yield(n.Current());n=null}if(f.MoveNext())if(f.Current()instanceof Array){t.Dispose(n),n=w(f.Current()).SelectMany(i.Identity).Flatten().GetEnumerator();continue}else return this.Yield(f.Current());return!1}},function(){try{t.Dispose(f)}finally{t.Dispose(n)}})})},n.prototype.Pairwise=function(i){var u=this;return new n(function(){var n;return new r(function(){n=u.GetEnumerator(),n.MoveNext()},function(){var t=n.Current();return n.MoveNext()?this.Yield(i(t,n.Current())):!1},function(){return t.Dispose(n)})})},n.prototype.Scan=function(i,u,f){var o=this,e;return f?this.Scan(i,u).Select(f):(e=!!i,new n(function(){var n,s=!0,f;return new r(function(){return n=o.GetEnumerator()},function(){if(s){if(s=!1,e)return this.Yield(f=i);if(n.MoveNext())return this.Yield(f=n.Current())}return n.MoveNext()?this.Yield(f=u(f,n.Current())):!1},function(){return t.Dispose(n)})}))},n.prototype.Select=function(i){var u=this;return new n(function(){var n,f=0;return new r(function(){return n=u.GetEnumerator()},function(){return n.MoveNext()?this.Yield(i(n.Current(),f++)):!1},function(){return t.Dispose(n)})})},n.prototype.SelectMany=function(u,f){var e=this;return u=u||i.Identity,f||(f=function(n,t){return t}),new n(function(){var i,n,o=0;return new r(function(){return i=e.GetEnumerator()},function(){if(!n&&!i.MoveNext())return!1;do{if(!n){var r=u(i.Current(),o++);n=w(r).GetEnumerator()}if(n.MoveNext())return this.Yield(f(i.Current(),n.Current()));t.Dispose(n),n=null}while(i.MoveNext());return!1},function(){try{t.Dispose(i)}finally{t.Dispose(n)}})})},n.prototype.Where=function(i){var u=this;return new n(function(){var n,f=0;return new r(function(){return n=u.GetEnumerator()},function(){while(n.MoveNext())if(i(n.Current(),f++))return this.Yield(n.Current());return!1},function(){return t.Dispose(n)})})},n.prototype.Zip=function(i,u){var f=this;return new n(function(){var o=0,n,e;return new r(function(){n=f.GetEnumerator(),e=s(i).GetEnumerator()},function(){return n.MoveNext()&&e.MoveNext()?this.Yield(u(n.Current(),e.Current(),o++)):!1},function(){try{t.Dispose(n)}finally{t.Dispose(e)}})})},n.prototype.Join=function(u,f,e,o,s){var h=this;return new n(function(){var n,l,c=null,v=0;return new r(function(){n=h.GetEnumerator(),l=a(u).ToLookup(e,i.Identity,s)},function(){for(var t,i;;){if(c){if(t=c[v++],t!==undefined)return this.Yield(o(n.Current(),t));t=null,v=0}if(n.MoveNext())i=f(n.Current()),c=l.Get(i).ToArray();else return!1}},function(){return t.Dispose(n)})})},n.prototype.GroupJoin=function(u,f,e,o,s){var h=this;return new n(function(){var n,c;return new r(function(){n=h.GetEnumerator(),c=a(u).ToLookup(e,i.Identity,s)},function(){if(n.MoveNext()){var t=c.Get(f(n.Current()));return this.Yield(o(n.Current(),t))}return!1},function(){return t.Dispose(n)})})},n.prototype.All=function(n){var t=!0;return this.ForEach(function(i){if(!n(i))return t=!1,!1}),t},n.prototype.Any=function(n){var i=this.GetEnumerator();try{if(!n)return i.MoveNext();while(i.MoveNext())if(n(i.Current()))return!0;return!1}finally{t.Dispose(i)}},n.prototype.Concat=function(i){var u=this;return new n(function(){var f,n;return new r(function(){return f=u.GetEnumerator()},function(){if(!n){if(f.MoveNext())return this.Yield(f.Current());n=s(i).GetEnumerator()}return n.MoveNext()?this.Yield(n.Current()):!1},function(){try{t.Dispose(f)}finally{t.Dispose(n)}})})},n.prototype.Insert=function(i,u){var f=this;return new n(function(){var e,n,o=0,h=!1;return new r(function(){e=f.GetEnumerator(),n=s(u).GetEnumerator()},function(){return o===i&&n.MoveNext()?(h=!0,this.Yield(n.Current())):e.MoveNext()?(o++,this.Yield(e.Current())):!h&&n.MoveNext()?this.Yield(n.Current()):!1},function(){try{t.Dispose(e)}finally{t.Dispose(n)}})})},n.prototype.Alternate=function(i){var u=this;return new n(function(){var n,f=!1;return new r(function(){return n=u.GetEnumerator()},function(){return f?(f=!1,this.Yield(i)):n.MoveNext()?(f=!0,this.Yield(n.Current())):!1},function(){return t.Dispose(n)})}).TakeExceptLast()},n.prototype.Contains=function(n,r){r=r||i.Identity;var u=this.GetEnumerator();try{while(u.MoveNext())if(r(u.Current())===n)return!0;return!1}finally{t.Dispose(u)}},n.prototype.DefaultIfEmpty=function(i){var u=this;return new n(function(){var n,f=!0;return new r(function(){return n=u.GetEnumerator()},function(){return n.MoveNext()?(f=!1,this.Yield(n.Current())):f?(f=!1,this.Yield(i)):!1},function(){return t.Dispose(n)})})},n.prototype.Distinct=function(n){return this.Except(p(),n)},n.prototype.Except=function(u,f){var e=this;return f=f||i.Identity,new n(function(){var n,i;return new r(function(){n=e.GetEnumerator(),i=new c(f),s(u).ForEach(function(n){return i.Add(n)})},function(){while(n.MoveNext()){var t=n.Current();if(!i.Contains(t))return i.Add(t),this.Yield(t)}return!1},function(){return t.Dispose(n)})})},n.prototype.Intersect=function(u,f){var e=this;return f=f||i.Identity,new n(function(){var n,i,o;return new r(function(){n=e.GetEnumerator(),i=new c(f),s(u).ForEach(function(n){return i.Add(n)}),o=new c(f)},function(){while(n.MoveNext()){var t=n.Current();if(!o.Contains(t)&&i.Contains(t))return o.Add(t),this.Yield(t)}return!1},function(){return t.Dispose(n)})})},n.prototype.SequenceEqual=function(n,r){var f,u;r=r||i.Identity,f=this.GetEnumerator();try{u=s(n).GetEnumerator();try{while(f.MoveNext())if(!u.MoveNext()||r(f.Current())!==r(u.Current()))return!1;return u.MoveNext()?!1:!0}finally{t.Dispose(u)}}finally{t.Dispose(f)}},n.prototype.Union=function(u,f){var e=this;return f=f||i.Identity,new n(function(){var o,n,i;return new r(function(){o=e.GetEnumerator(),i=new c(f)},function(){var t;if(!n){while(o.MoveNext())if(t=o.Current(),!i.Contains(t))return i.Add(t),this.Yield(t);n=s(u).GetEnumerator()}while(n.MoveNext())if(t=n.Current(),!i.Contains(t))return i.Add(t),this.Yield(t);return!1},function(){try{t.Dispose(o)}finally{t.Dispose(n)}})})},n.prototype.Reverse=function(){var t=this;return new n(function(){var n,u;return new r(function(){n=t.ToArray(),u=n.length},function(){return u>0?this.Yield(n[--u]):!1},i.Blank)})},n.prototype.Shuffle=function(){var t=this;return new n(function(){var n;return new r(function(){return n=t.ToArray()},function(){if(n.length>0){var t=Math.floor(Math.random()*n.length);return this.Yield(n.splice(t,1)[0])}return!1},i.Blank)})},n.prototype.GroupBy=function(u,f,e,o){var s=this;return f=f||i.Identity,o=o||i.Identity,new n(function(){var n;return new r(function(){return n=s.ToLookup(u,f,o).ToEnumerable().GetEnumerator()},function(){while(n.MoveNext())return e?this.Yield(e(n.Current().Key(),n.Current())):this.Yield(n.Current());return!1},function(){return t.Dispose(n)})})},n.prototype.PartitionBy=function(u,f,e,o){var s=this;return f=f||i.Identity,o=o||i.Identity,e||(e=function(n,t){return new d(n,t)}),new n(function(){var n,h,c,i=[];return new r(function(){n=s.GetEnumerator(),n.MoveNext()&&(h=u(n.Current()),c=o(h),i.push(f(n.Current())))},function(){for(var t,r;t=n.MoveNext();)if(c===o(u(n.Current())))i.push(f(n.Current()));else break;return i.length>0?(r=e(h,i),t?(h=u(n.Current()),c=o(h),i=[f(n.Current())]):i=[],this.Yield(r)):!1},function(){return t.Dispose(n)})})},n.prototype.Aggregate=function(n,t,i){return this.Scan(n,t,i).Last()},n.prototype.Average=function(n){n=n||i.Identity;var t=0,r=0;return this.ForEach(function(i){t+=n(i),++r}),t/r},n.prototype.Count=function(n){n=n||i.True;var t=0;return this.ForEach(function(i,r){n(i,r)&&++t}),t},n.prototype.Max=function(n){return n=n||i.Identity,this.Select(n).Aggregate(function(n,t){return n>t?n:t})},n.prototype.Min=function(n){return n=n||i.Identity,this.Select(n).Aggregate(function(n,t){return n<t?n:t})},n.prototype.MaxBy=function(n){return this.Aggregate(function(t,i){return n(t)>n(i)?t:i})},n.prototype.MinBy=function(n){return this.Aggregate(function(t,i){return n(t)<n(i)?t:i})},n.prototype.Sum=function(n){return n=n||i.Identity,this.Select(n).Aggregate(0,function(n,t){return n+t})},n.prototype.ElementAt=function(n){var t,i=!1;if(this.ForEach(function(r,u){if(u===n)return t=r,i=!0,!1}),!i)throw new Error("ElementAt: Index is less than 0 or greater than or equal to the number of elements in the sequence.");return t},n.prototype.ElementAtOrDefault=function(n,t){var i,r=!1;return this.ForEach(function(t,u){if(u===n)return i=t,r=!0,!1}),r?i:t},n.prototype.First=function(n){var t,i=!1;if(this.ForEach(function(r){if(!n||n(r))return t=r,i=!0,!1}),!i)throw new Error("First: No element satisfies the condition.");return t},n.prototype.FirstOrDefault=function(n,t){var i,r=!1;return this.ForEach(function(n){if(!t||t(n))return i=n,r=!0,!1}),r?i:n},n.prototype.Last=function(n){var t,i=!1;if(this.ForEach(function(r){(!n||n(r))&&(i=!0,t=r)}),!i)throw new Error("Last: No element satisfies the condition.");return t},n.prototype.LastOrDefault=function(n,t){var i,r=!1;return this.ForEach(function(n){(!t||t(n))&&(r=!0,i=n)}),r?i:n},n.prototype.Single=function(n){var i,t=!1;if(this.ForEach(function(r){if(!n||n(r))if(t)throw new Error("Single: Sequence contains more than one element satisfying the condition.");else t=!0,i=r}),!t)throw new Error("Single: No element in the sequence satisfies the condition.");return i},n.prototype.SingleOrDefault=function(n,t){var r,i=!1;return this.ForEach(function(n){if(!t||t(n))if(i)throw new Error("Single: Sequence contains more than one element satisfying the condition.");else i=!0,r=n}),i?r:n},n.prototype.Skip=function(i){var u=this;return new n(function(){var n,f=0;return new r(function(){for(n=u.GetEnumerator();f++<i&&n.MoveNext(););},function(){return n.MoveNext()?this.Yield(n.Current()):!1},function(){return t.Dispose(n)})})},n.prototype.SkipWhile=function(i){var u=this;return new n(function(){var n,e=0,f=!1;return new r(function(){return n=u.GetEnumerator()},function(){while(!f)if(n.MoveNext()){if(!i(n.Current(),e++))return f=!0,this.Yield(n.Current());continue}else return!1;return n.MoveNext()?this.Yield(n.Current()):!1},function(){return t.Dispose(n)})})},n.prototype.Take=function(i){var u=this;return new n(function(){var n,f=0;return new r(function(){return n=u.GetEnumerator()},function(){return f++<i&&n.MoveNext()?this.Yield(n.Current()):!1},function(){return t.Dispose(n)})})},n.prototype.TakeWhile=function(i){var u=this;return new n(function(){var n,f=0;return new r(function(){return n=u.GetEnumerator()},function(){return n.MoveNext()&&i(n.Current(),f++)?this.Yield(n.Current()):!1},function(){return t.Dispose(n)})})},n.prototype.TakeExceptLast=function(i){var u=this;return(i===undefined||i===null)&&(i=1),new n(function(){if(i<=0)return u.GetEnumerator();var n,f=[];return new r(function(){return n=u.GetEnumerator()},function(){while(n.MoveNext()){if(f.length===i)return f.push(n.Current()),this.Yield(f.shift());f.push(n.Current())}return!1},function(){return t.Dispose(n)})})},n.prototype.TakeFromLast=function(i){var u=this;return i<=0||i===undefined||i===null?p():new n(function(){var e,n,f=[];return new r(function(){return e=u.GetEnumerator()},function(){while(e.MoveNext())f.length===i&&f.shift(),f.push(e.Current());return n||(n=h(f).GetEnumerator()),n.MoveNext()?this.Yield(n.Current()):!1},function(){return t.Dispose(n)})})},n.prototype.IndexOf=function(n){var t=-1;return this.ForEach(function(i,r){if(i===n)return t=r,!0}),t},n.prototype.LastIndexOf=function(n){var t=-1;return this.ForEach(function(i,r){i===n&&(t=r)}),t},n.prototype.ToArray=function(){var n=[];return this.ForEach(function(t){return n.push(t)}),n},n.prototype.ToLookup=function(n,t,r){t=t||i.Identity,r=r||i.Identity;var u=new y(r);return this.ForEach(function(i){var r=n(i),f=t(i),e=u.Get(r);e?e.push(f):u.Add(r,[f])}),new nt(u)},n.prototype.ToObject=function(n,t){var i={};return this.ForEach(function(r){return i[n(r)]=t(r)}),i},n.prototype.ToDictionary=function(n,t,r){t=t||i.Identity,r=r||i.Identity;var u=new y(r);return this.ForEach(function(i){return u.Add(n(i),t(i))}),u},n.prototype.ToJSON=function(n,t){return JSON.stringify(this.ToArray(),n,t)},n.prototype.ToString=function(n,t){return n||(n=""),t=t||i.Identity,this.Select(t).ToArray().join(n)},n.prototype.Do=function(i){var u=this;return new n(function(){var n,f=0;return new r(function(){return n=u.GetEnumerator()},function(){return n.MoveNext()?(i(n.Current(),f++),this.Yield(n.Current())):!1},function(){return t.Dispose(n)})})},n.prototype.ForEach=function(n,i){var u=0,r=this.GetEnumerator();try{while(r.MoveNext())if(i){if(n.call(i,r.Current(),u++)===!1)break}else if(n(r.Current(),u++)===!1)break}finally{t.Dispose(r)}},n.prototype.Write=function(n,t){n||(n=""),t=t||i.Identity;var r=!0;this.ForEach(function(i){r?r=!1:document.write(n||""),document.write(t(i))})},n.prototype.WriteLine=function(n){n=n||i.Identity,this.ForEach(function(t){document.write(n(t)),document.write("<br />")})},n.prototype.Force=function(){var n=this.GetEnumerator();try{while(n.MoveNext());}finally{t.Dispose(n)}},n.prototype.Let=function(i){var u=this;return new n(function(){var n;return new r(function(){return n=a(i(u)).GetEnumerator()},function(){return n.MoveNext()?this.Yield(n.Current()):!1},function(){return t.Dispose(n)})})},n.prototype.Share=function(){var u=this,t;return new n(function(){return new r(function(){t||(t=u.GetEnumerator())},function(){return t.MoveNext()?this.Yield(t.Current()):!1},i.Blank)})},n.prototype.MemoizeAll=function(){var f=this,t,u;return new n(function(){var n=-1;return new r(function(){u||(u=f.GetEnumerator(),t=[])},function(){return(n++,t.length<=n)?u.MoveNext()?this.Yield(t[n]=u.Current()):!1:this.Yield(t[n])},i.Blank)})},n.prototype.Catch=function(i){var u=this;return new n(function(){var n;return new r(function(){return n=u.GetEnumerator()},function(){try{return n.MoveNext()?this.Yield(n.Current()):!1}catch(t){return i&&i(t),!1}},function(){return t.Dispose(n)})})},n.prototype.Finally=function(i){var u=this;return new n(function(){var n;return new r(function(){return n=u.GetEnumerator()},function(){return n.MoveNext()?this.Yield(n.Current()):!1},function(){try{t.Dispose(n)}finally{i&&i()}})})},n.prototype.Trace=function(n,t){return(n===undefined||n===null)&&(n="Trace"),t=t||i.Identity,this.Do(function(i){return console.log(n,":",t(i))})},n}(),n.Enumerable=u,et=function(){function n(n,t,i){this.keys=null,this.keySelector=n,this.descending=t,this.child=i}return n.prototype.GenerateKeys=function(n){this.keys=h(n).Select(this.keySelector).ToArray(),this.child&&this.child.GenerateKeys(n)},n.prototype.Compare=function(n,i){var r=t.Compare(this.keys[n],this.keys[i]);if(r===0){if(this.child)return this.child.Compare(n,i);r=t.Compare(n,i)}return this.descending?-r:r},n}(),b=function(n){function t(t,u,f,e){var o=this;n.call(this,null),this.source=t,this.keySelector=u,this.descending=f,this.parent=e,this.GetEnumerator=function(){var t,n,u=0;return new r(function(){t=[],n=[],o.source.ForEach(function(i,r){t.push(i),n.push(r)});var i=ft(o,null);i.GenerateKeys(t),n.sort(function(n,t){return i.Compare(n,t)})},function(){return u<n.length?this.Yield(t[n[u++]]):!1},i.Blank)}}return __extends(t,n),t.prototype.CreateOrderedEnumerable=function(n,i){return new t(this.source,n,i,this)},t.prototype.ThenBy=function(n){return this.CreateOrderedEnumerable(n,!1)},t.prototype.ThenByDescending=function(n){return this.CreateOrderedEnumerable(n,!0)},t}(u),n.OrderedEnumerable=b,k=function(n){function t(t){var f=this,u;n.call(this,null),this.source=t,u=this.source,this.GetEnumerator=function(){var n=0;return new r(i.Blank,function(){while(n<u.length)return this.Yield(u[n++]);return!1},i.Blank)}}return __extends(t,n),t.prototype.Any=function(t){return t?n.prototype.Any.call(this,t):this.source.length>0},t.prototype.Count=function(t){return t?n.prototype.Count.call(this,t):this.source.length},t.prototype.ElementAt=function(t){return 0<=t&&t<this.source.length?this.source[t]:n.prototype.ElementAt.call(this,t)},t.prototype.ElementAtOrDefault=function(n,t){return 0<=n&&n<this.source.length?this.source[n]:t},t.prototype.First=function(t){return!t&&this.source.length>0?this.source[0]:n.prototype.First.call(this,t)},t.prototype.FirstOrDefault=function(t,i){return i?n.prototype.FirstOrDefault.call(this,t,i):this.source.length>0?this.source[0]:t},t.prototype.Last=function(t){return!t&&this.source.length>0?this.source[this.source.length-1]:n.prototype.Last.call(this,t)},t.prototype.LastOrDefault=function(t,i){return i?n.prototype.LastOrDefault.call(this,t,i):this.source.length>0?this.source[this.source.length-1]:t},t.prototype.Skip=function(n){var f=this,t=this.source;return new u(function(){var u;return new r(function(){return u=n<0?0:n},function(){while(u<t.length)return this.Yield(t[u++]);return!1},i.Blank)})},t.prototype.TakeExceptLast=function(n){return(n===undefined||n===null)&&(n=1),this.Take(this.source.length-n)},t.prototype.TakeFromLast=function(n){return this.Skip(this.source.length-n)},t.prototype.Reverse=function(){var t=this,n=this.source;return new u(function(){var t;return new r(function(){return t=n.length},function(){return t>0?this.Yield(n[--t]):!1},i.Blank)})},t.prototype.SequenceEqual=function(i,r){return(i instanceof t||i instanceof Array)&&!r&&s(i).Count()!==this.Count()?!1:n.prototype.SequenceEqual.call(this,i,r)},t.prototype.ToString=function(t,i){return i?n.prototype.ToString.call(this,t,i):(t||(t=""),this.source.join(t))},t}(u),n.ArrayEnumerable=k,d=function(n){function t(t,i){n.call(this,i),this.key=t}return __extends(t,n),t.prototype.Key=function(){return this.key},t}(k),n.Grouping=d})(LINQ||(LINQ={}));
